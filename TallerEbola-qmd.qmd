---
title: "Estad√≠sticas y m√©todos para el an√°lisis de la respuesta a brotes."
subtitle: "D√≠a 2"
format: revealjs
editor: visual
---

## Agenda:

1.  Introducci√≥n (10min)

2.  Taller (100min)

3.  Discusi√≥n (30min)

## Contexto:

-   La **enfermedad por el virus del √©bola (EVE)** apareci√≥ en **1976** en brotes casi simult√°neos en la Rep√∫blica **Democr√°tica del Congo (RDC)** y **Sud√°n del Sur**

-   Entre **1979 y 1994** no se detectaron casos ni brotes

-   Desde **1994 se han reconocido brotes** con una frecuencia cada vez mayor

-   El mayor brote hasta la fecha tuvo lugar en **√Åfrica Occidental** entre **marzo de 2014 y junio de 2016**

::: notes
**Oubreaks of EBOV**

-   The **disease caused by the Ebola virus (EVE)** appeared in **1976** in almost simultaneous outbreaks in the **Democratic Republic of the Congo (DRC)** and **South Sudan.**

<!-- -->

-   Between **1979** ndefinedand **1994**ndefined, no cases or outbreak

-   Since 1994, **outbreaks have been recognized** with increasing frequency.

-   The largest outbreak to date occurred in **West Africa** between **March 2014 and June 2016.**
:::

## Taxonom√≠a y transmisi√≥n del virus del √âbola

![doi: 10.1038/s41572-020-0147-3.](TallerEbola-qmd_files/img/taxonomia-ebola.png)

::: notes
**Filovirus taxonomy and Ebola virus transmission.**

**a** Taxonomy of the genus *Ebolavirus.* Thus far, five ebolaviruses have been associated with human infections, and four of them have been identified as pathogens.

**b.**

-   The natural reservoir host(s) of Ebola virus (EBOV) has (have) yet to be identified. Multiple data indicate a direct or indirect role of bats in EBOV ecology, but to date, EBOV has not been isolated from, nor its near-complete genome been detected in any wild animal.

<!-- -->

-   **It is tempting to speculate that Ebola virus disease (EVD) spread is a zoonotic** because identified index cases of EVD outbreaks had been identified to be individuals that had been in contact with wild animals or had handled the carcass of a possible accidental EBOV host.
:::

## Brotes del virus del √©bola

![doi: 10.1038/s41572-020-0147-3.](TallerEbola-qmd_files/img/ebola_outbreaks.jpg)

::: notes
**Oubreaks of EBOV**

-   **Between 1979 and 1994 no cases or outbreaks were detected**. However, since that time, outbreaks have been recognized with increasing frequency.

<!-- -->

-   The largest outbreak to date took place in **West AFrica between March 2014 and June 2016**, affecting primarily Guinea, Liberia and Sierra Leone. **Over 28000 cases were recorded.**
:::

## Curso cl√≠nico

::: columns
::: {.column width="70%"}
![Nat Rev Dis Primers 2020 Feb 20;6(1):13. ¬†doi: 10.1038/s41572-020-0147-3.](TallerEbola-qmd_files/img/curso-clinico-ebola.png)
:::

::: {.column width="30%"}
![](TallerEbola-qmd_files/img/curso-clinico-ebola-legend.png) <font size="5">

Alta letalidad:

De 5986 casos a nivel mundial fuera del brote de √Åfrica Occidental han muerto 3963 (CFR 66%)

</font>
:::
:::

::: notes
**High lethatility:**

From 5986 global cases besides the West Africa outbreak cases, 3963 died (CFR 66%)
:::

# Instrucciones del taller

## Introducci√≥n

-   Esta pr√°ctica simula **la evaluaci√≥n temprana** y la **reconstrucci√≥n** de un **brote** de enfermedad por el **virus del √âbola (EVE).**

<font size="6">

-   Conceptos b√°sicos a desarrollar:

    -   **Razon de letalidad por caso** (CFR - *Case Fatality **Ratio***)

    -   **Curvas epidemiol√≥gicas** (e.g. Incidencia de casos - $I_t$)

    -   **Rastreo de contactos**

    -   **Tiempo de duplicaci√≥n** y **tasa de crecimiento**

    -   **Intervalo Serial** (SI - *Serial Inverval*)

    -   **N√∫mero reproductivo instant√°neo** ($R_t$)

</font>

## Objetivos

<font size="6">

-   Estimar la **razon de letalidad por caso (CFR)**

-   Calcular, visualizar la **incidencia de casos** ($I_t$)

-   Identificar par√°metros descriptivos de la transmisi√≥n de una **enfermedad infecciosa (humano-humano)**.¬†

-   Estimar e interpretar la **tasa de crecimiento** y el **tiempo de duplicaci√≥n** de la epidemia.

-   Estimar e interpretar el **n√∫mero de reproducci√≥n instant√°neo** de la epidemia ($R_t$)

</font>

# Situaci√≥n a analizar

## Hay un nuevo brote de EVE en un pa√≠s ficticio de √Åfrica occidental

<br>

-   Se ha notificado un nuevo brote de EVE en un pa√≠s ficticio de √Åfrica occidental.¬†

<br>

-   El Ministerio de Salud se encarga de coordinar la respuesta al brote, y lo ha contratado a usted como consultor en an√°lisis epid√©mico para informar la respuesta en tiempo real.

## Al inicio del brote

::: columns
::: {.column width="70%"}
![https://www.reconlearn.org/post/outbreakstatsprimer.html](TallerEbola-qmd_files/img/inicio_del_brote.png)
:::

::: {.column width="30%"}
An√°lisis r√°pido de la situaci√≥n para orientar la toma de decisiones

<br><br>

**¬øQu√© preguntas surgen inmediatamente?**
:::
:::

## Al inicio del brote

Se requieren datos para **planear la respuesta a:**

-   ¬øQu√© tan r√°pido crece una epidemia?

-   ¬øCu√°l es el riesgo de muerte?

-   ¬øCu√°ntos casos puedo esperar en los pr√≥ximos d√≠as?

-   ¬øCu√°nta capacidad hospitalaria y del sistema de salud requeriremos en los pr√≥ximos d√≠as?

<center>

### ¬øQu√© datos necesito?

</center>

## Datos disponibles usuales en epidemias nuevas

-   Fecha de inicio de s√≠ntomas: *date of onset*

-   Fecha de exposici√≥n/infecci√≥n: *infection date*

-   Fecha del desenlace (recuperaci√≥n, muerte): *outcome date*

-   Datos generales del individuo: edad, g√©nero, ocupaci√≥n, etc

-   Datos de brotes anteriores

## Metodolog√≠a del taller

La pr√°ctica est√° divida en 6 secciones. En cada una de ellas vamos a tener:

1.  Explicaciones de los conceptos a trabajar
2.  Espacio de lectura y ejecuci√≥n del c√≥digo
3.  Espacios de reflexi√≥n y discusi√≥n

# Pasemos a R üë©‚Äçüíªüë®‚Äçüíª

## Instrucciones:

<br>

### Desarrolle la secci√≥n *1. Preparaci√≥n*

```{r}
countdown::countdown(minutes = 5, seconds = 00, left=0, right=0)
```

## Cargue las librer√≠as necesarias:

<br>

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
library(tidyverse) # contiene ggplot2, dplyr, tidyr, readr, purrr, tibble
library(readxl) # para leer archivos Excel
library(binom) # para intervalos de confianza binomiales
library(knitr) # para crear tablas bonitas con kable()
library(incidence) # para calcular incidencia y ajustar modelos
library(EpiEstim) # para estimar R(t)
```

## Cargue las bases de datos:

<br>

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
directorio_casos <- read_rds("data/directorio_casos.rds")
contactos <- read_excel("data/contactos_20140701.xlsx", na = c("", "NA"))
```

## Estructura de los datos:

<font size="6">

<div>

```{r, echo=TRUE}
glimpse(contactos)
```

```{r, echo=TRUE}
glimpse(directorio_casos)
```

</div>

</font>

<font size="5">

-   ¬øSon los datos y el formato similares a bases de datos de casos que ha visto en el pasado?

-   ¬øQu√© otra informaci√≥n le gustar√≠a recopilar?

</font>

## Probabilidad de muerte en los casos reportados (CFR)

**CFR: *Case Fatality Ratio***

![https://www.reconlearn.org/post/outbreakstatsprimer.html](TallerEbola-qmd_files/img/CFR_pie.png)

## **No confundir CFR con IFR**

-   **CFR:** Es la **probabilidad de muerte** a causa de la infecci√≥n para los **casos reportados**:

    $\rightarrow$ <font size="5"> El CFR se puede calcular con los datos de vigilancia epidemiol√≥gica </font>

$$
\text{CFR} = \frac{\text{# de muertes confirmadas}}{\text{# casos con desenlace conocido}}
$$

-   **IFR:** Es la **probabilidad de muerte** a causa de la infecci√≥n teniendo en cuenta **infecciones detectadas y no detectadas**

    $\rightarrow$ <font size="5"> IFR s√≥lo se puede calcular con datos de vigilancia epidemiol√≥gica + informaci√≥n adicional como estudios prevalencia </font>

## Instrucciones

<br>

### Lea y desarrolle la secci√≥n *2. CFR*

<br>

```{r, echo=FALSE}
countdown::countdown(minutes = 5, seconds = 00, left=0, right=0)
```

## Tasa de fatalidad de casos (CFR)

<font size="5">

::: columns
::: {.column width="55%"}
```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
table(directorio_casos$desenlace, useNA = "ifany")
```
:::

::: {.column width="45%"}
¬øC√≥mo calcular√≠a el CFR a partir de esto?

Piense en qu√© hacer con los casos cuyo resultado es \`NA\`
:::
:::

</font>

## Tasa de fatalidad de casos (CFR)

<font size="5">

::: columns
::: {.column width="55%"}
```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
table(directorio_casos$desenlace, useNA = "ifany")
```
:::

::: {.column width="45%"}
¬øC√≥mo calcular√≠a el CFR a partir de esto?

Piense en qu√© hacer con los casos cuyo resultado es \`NA\`
:::
:::

::: columns
::: {.column width="65%"}
```{r echo=TRUE, message=FALSE, warning=FALSE,comment="", results=FALSE}
numero_muertes <- sum(directorio_casos$desenlace %in% "Muerte")
numero_casos_resultado_conocido <- sum(directorio_casos$desenlace %in% c("Muerte", "Recuperacion"))   
CFR <- numero_muertes / numero_casos_resultado_conocido
CFR
```
:::

::: {.column width="35%"}
C√°lculo de CFR
:::
:::

::: columns
::: {.column width="65%"}
```{r echo=FALSE, message=FALSE, warning=FALSE,comment=""}
CFR_con_CI <- binom.confint(numero_muertes, numero_casos_resultado_conocido, method = "exact") %>%
  kable(caption = "**CFR con intervalos de confianza**") 
CFR_con_CI
```
:::

::: {.column width="35%"}
¬øC√≥mo interpreta estos resultados?
:::
:::

</font>

## Incidencia

<font size="6">

**N√∫mero de casos nuevos en un per√≠odo de tiempo determinado**

-   Se basa en las fechas, por lo general, de inicio de s√≠ntomas.

-   Se afecta por los **rezagos de reporte** (e.g. quienes iniciaron s√≠ntomas ayer s√≥lo van a ser reportados algunos d√≠as despu√©s)

</font>

![https://www.repidemicsconsortium.org/incidence/](TallerEbola-qmd_files/img/ebola-incidence-pkg.png)

## Incidencia

<font size="6">

-   El primer paso del an√°lisis es descriptivo: **queremos dibujar una epicurva o curva epidemiol√≥gica**. Esto permite visualizar la incidencia a lo largo del tiempo por fecha de inicio de los s√≠ntomas.

-   La primera pregunta que queremos responder es:¬† **¬øqu√© tan grave es la situaci√≥n?**

</font>

### **Para ello, ¬°miraremos las curvas de incidencia!**

## <font size=14>Curva epid√©mica con modelo log lineal</font>

![https://www.reconlearn.org/post/outbreakstatsprimer.html](TallerEbola-qmd_files/img/curv_epi_loglineal.png)

<font size="5.5">

$$ \left. \begin{matrix} y:\text{n√∫mero de casos incidentes} \\ r:\text{tasa de crecimiento} \\ \beta_0: \text{intercepto} \end{matrix} \right\} \log(y) = \beta_0 + rt + \epsilon \Rightarrow \hat{y} = \exp^{rt+\beta_0} $$

</font>

<center>

<font size="6">

[**¬°La tasa de crecimiento es la pendiente de la recta en escala logar√≠tmica!**]{.underline}

</font>

</center>

## Tiempo de duplicaci√≥n

::: columns
::: {.column width="60%"}
<font size="5"> [![https://www.reconlearn.org/post/outbreakstatsprimer.html](TallerEbola-qmd_files/img/doubling_time_scheme.png){alt="https://www.reconlearn.org/post/outbreakstatsprimer.html"}](#0)

$$ \left. \begin{matrix} y:\text{n√∫mero de casos incidentes} \\ r:\text{tasa de crecimiento} \\ \beta_0: \text{intercepto} \end{matrix} \right\} \hat{y} = \exp^{rt + \beta_0} $$

</font>
:::

::: {.column width="40%"}
$T$ es el tiempo que le toma a la curva epid√©mica para **duplicarse:**

$$  \hat{y}_2 = 2\hat{y}_1 \\ 2 = \frac{\hat{y}_2}{\hat{y}_1} = \frac{\exp^{rt_2 + \beta_0}}{\exp^{rt_1 + \beta_0}} \\ 2 = \exp^{r(t_2-t_1)} = \exp^{rT}\\ \Rightarrow T = \frac{\log(2)}{r} $$
:::
:::

## Instrucciones

### <br>

### Lea y desarrolle las secciones:

### *3. Incidencia*

### *4. Tasa de crecimiento*

<br>

```{r}
countdown::countdown(minutes = 15, seconds = 00)
```

## <font size="9">Incidencia diaria seg√∫n fecha de inicio de s√≠ntomas</font>

```{r, eval=FALSE, echo=TRUE}
incidencia_diaria <- incidence(directorio_casos$fecha_inicio_sintomas)
incidencia_diaria
```

::: columns
::: {.column width="30%"}
```{r}
incidencia_diaria <- incidence(directorio_casos$fecha_inicio_sintomas)
incidencia_diaria
```
:::

::: {.column width="70%"}
```{r, echo=FALSE}
plot(incidencia_diaria, border = "black")
```

```{r, echo=TRUE, eval=FALSE}
plot(incidencia_diaria, border = "black")
```
:::
:::

<center>**¬øQu√© observa?**</center>

## Pregunta {visibility="hidden"}

### ¬øCu√°l es la mejor clasificaci√≥n de la epidemia a partir de la informaci√≥n de la curva epid√©mica?

A. Fuente com√∫n puntual

B. Fuente com√∫n continua

C. Fuente com√∫n intermitente

D. Propagada (persona a persona)

## Pregunta {visibility="hidden"}

### Su jefe le pregunta, ¬øen qu√© fecha inici√≥ s√≠ntomas el primer caso (caso √≠ndice)?

Usted dir√≠a que fue...

```{r echo=FALSE, message=FALSE, warning=FALSE,comment=""}
plot(incidencia_diaria, border = "black")
```

## Incidencia de casos semanal

<font size="6">

-   Otro problema es que **puede ser dif√≠cil interpretar las tendencias al observar la incidencia diaria**

-   Calcule la incidencia semanal:

```{r, eval=TRUE, echo=TRUE}
incidencia_semanal <- incidence(directorio_casos$fecha_inicio_sintomas, 
                                interval = 7, 
                                last_date = max(directorio_casos$fecha_de_hospitalizacion,
                                                na.rm = TRUE))
incidencia_semanal
```

</font>

## Incidencia de casos semanal

-   Grafique la incidencia semanal:

```{r, eval=TRUE, echo=TRUE}
plot(incidencia_semanal, border = "black")
```

<center>**¬øQu√© opina de esta nueva gr√°fica?**</center>

## Estimaci√≥n de la tasa de crecimiento mediante un modelo¬† log-lineal

-   El modelo *log-lineal* es uno de los **modelos de incidencia m√°s simple**

-   Es un **modelo de regresi√≥n lineal implementado sobre incidencias transformadas logar√≠tmicamente**

-   Trabajaremos con **incidencia semanal**, para evitar tener problemas con valores de incidencia cero.

## <font size=14>Curva epid√©mica con modelo log lineal</font>

::: columns
::: {.column width="30%"}
<font size="5">

-   Grafique la incidencia transformada logar√≠tmicamente
-   ¬øQu√© le dice esta gr√°fica sobre la epidemia?

</font>

![](TallerEbola-qmd_files/img/curv_epi_exp.png)
:::

::: {.column width="70%"}
```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
incidencia_semanal_df <- as.data.frame(incidencia_semanal)

  ggplot(incidencia_semanal_df) + 
  geom_point(aes(x = dates, y = log(counts))) + 
  scale_x_date(date_breaks = "1 week", date_labels = "%d-%b") +
  xlab("Fecha") +
  ylab("Incidencia semanal logar√≠tmica") + 
  theme_minimal()
```
:::
:::

::: notes
**Respuesta:** Se observa un incremento exponencial de casos semanales hasta la semana 23 (mediados de junio)
:::

## <font size=14>Curva epid√©mica con modelo log lineal</font>

#### Ajuste un modelo log-lineal a los datos de incidencia

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
ajuste_modelo <- incidence::fit(incidencia_semanal)
ajuste_modelo
```

<center>**¬øQu√© le dicen estos datos?**</center>

## <font size=14>Curva epid√©mica con modelo log lineal</font>

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
plot(incidencia_semanal, fit = ajuste_modelo)
```

<center><font size="6">Mirando la gr√°fica y el ajuste, **¬øcree que este es un ajuste razonable?**</font></center>

::: notes
**Respuesta:** Lo observado se ajusta a un crecimiento exponencial, sin embargo, no es un ajuste razonable debido a que se continuan incuyendo las √∫ltimas semanas, las cuales presentan datos at√≠picos que pueden sesgar la gr√°fica (rezago)
:::

## <font size=12>Curva epid√©mica con modelo log lineal</font>

#### ¬øCu√°ntas semanas debe descartar al final de la epicurva?

-   Trunque la incidencia semanal seg√∫n las semanas descartadas

    ```{r echo=TRUE, message=FALSE, warning=FALSE,comment="", results=FALSE}
    semanas_a_descartar <- 2
    fecha_minima <- min(incidencia_diaria$dates)
    fecha_maxima <- max(incidencia_diaria$dates) - semanas_a_descartar * 7
    # Para truncar la incidencia semanal
    incidencia_semanal_truncada <- subset(incidencia_semanal, 
                             from = fecha_minima, 
                             to = fecha_maxima) # descarte las √∫ltimas semanas de datos

    # Incidencia diaria truncada. No la usamos para la regresi√≥n lineal pero se puede usar m√°s adelante
    incidencia_diaria_truncada <- subset(incidencia_diaria, 
                            from = fecha_minima, 
                            to = fecha_maxima) # eliminamos las √∫ltimas dos semanas de datos
    ```

## <font size=12>Curva epid√©mica con modelo log lineal</font>

<font size="6">

Vuelva a ajustar y a graficar el modelo logar√≠tmico lineal, pero utilizando los datos truncados.

```{r, echo=TRUE, eval=FALSE}
ajuste_modelo_semanal <- incidence::fit(incidencia_semanal_truncada)
ajuste_modelo_semanal
```

::: columns
::: {.column width="35%"}
```{r echo=FALSE, message=FALSE, warning=FALSE,comment=""}
ajuste_modelo_semanal <- incidence::fit(incidencia_semanal_truncada)
ajuste_modelo_semanal
```
:::

::: {.column width="65%"}
```{r echo=FALSE, message=FALSE, warning=FALSE,comment=""}
plot(incidencia_semanal_truncada, fit = ajuste_modelo_semanal)
```

```{r echo=TRUE, eval=FALSE}
plot(incidencia_semanal_truncada, fit = ajuste_modelo_semanal)
```
:::
:::

<center>**¬øCree que este es un ajuste m√°s razonable comparado con el anterior?**</center>

</font>

## <font size=14>Curva epid√©mica con modelo log lineal</font>

#### Observe las estad√≠sticas resumidas de su ajuste:

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
summary(ajuste_modelo_semanal$model)
```

**¬øEl modelo se ajusta bien a los datos?**

## <font size=14>Curva epid√©mica con modelo log lineal</font>

#### Estimacion de la tasa de crecimiento

¬øCu√°l es la tasa de crecimiento estimada de la epidemia?, ¬øC√≥mo lo interpreta?

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
# Estimaci√≥n de la tasa de crecimiento diaria
tasa_crecimiento_diaria <- ajuste_modelo_semanal$info$r
cat("La tasa de crecimiento diaria es:", tasa_crecimiento_diaria, "\n")

# Intervalo de confianza de la tasa de crecimiento diaria
tasa_crecimiento_IC <- ajuste_modelo_semanal$info$r.conf

cat("Intervalo de confianza de la tasa de crecimiento diaria (95%):", tasa_crecimiento_IC, "\n")
```

## Tiempo de duplicaci√≥n

¬øCu√°l es el **tiempo de duplicaci√≥n** estimado de la epidemia?,

¬øC√≥mo lo interpreta?

## Tiempo de duplicaci√≥n

¬øCu√°l es el **tiempo de duplicaci√≥n** estimado de la epidemia?,

¬øC√≥mo lo interpreta?

```{r, echo=TRUE}
# Estimaci√≥n del tiempo de duplicaci√≥n en d√≠as
tiempo_duplicacion_dias <- ajuste_modelo_semanal$info$doubling
cat("El tiempo de duplicaci√≥n de la epidemia en d√≠as es:", tiempo_duplicacion_dias, "\n")

# Intervalo de confianza del tiempo de duplicaci√≥n
tiempo_duplicacion_IC <- ajuste_modelo_semanal$info$doubling.conf
cat("Intervalo de confianza del tiempo de duplicaci√≥n (95%):", tiempo_duplicacion_IC, "\n")

```

## Intervalo serial:

El ***intervalo serial*** es el tiempo entre la fecha de inicio de s√≠ntomas entre casos primarios y secundarios

::: columns
::: {.column width="50%"}
![](TallerEbola-qmd_files/img/serial_interval_toon.png){alt="https://www.reconlearn.org/slides/outbreak-statistics/outbreak-statistics#16"}
:::

::: {.column width="50%"}
![](TallerEbola-qmd_files/img/serial_interval_dist.png)
:::
:::

<font size="5">

<https://www.reconlearn.org/slides/outbreak-statistics/outbreak-statistics#16>

</font>

## Modelo de proceso de ramificaci√≥n

-   ¬øQu√© es el **n√∫mero de reproducci√≥n** $R$ y para qu√© sirve?

-   En las primeras etapas de un brote, y asumiendo una gran poblaci√≥n sin inmunidad, esta cantidad corresponde al **n√∫mero de reproducci√≥n b√°sico** $R(0)$.

-   Cuando la suposici√≥n de que $R$ es constante no es sostenible, **una alternativa es estimar la transmisibilidad variable en el tiempo utilizando el n√∫mero de reproducci√≥n instant√°nea** $R_t$**.**

## Modelo de proceso de ramificaci√≥n

\[A√ëADIR IMAGEN\]

## Modelo de Poisson para la incidencia

-   La **fuerza de infecci√≥n** se puede calcular como

$$ \lambda_t \approx R_t \sum_{s=1}^{t-1} I_{s} w_{t-s} $$

En donde $R_t$ representa el n√∫mero de reproducci√≥n efectiyo y $w$ la distribuci√≥n del intervalo serial discreta.

## Modelo de Poisson para la incidencia

-   El paquete de R `{EpiEstim}` estima $R_t$ para ventanas de tiempo personalizadas **utilizando la distribuci√≥n de probabilidad de Poisson** \[Cori et al. 2013\]

-   Descripci√≥n de **la incidencia** por medio de la ecuaci√≥n de renovaci√≥n:

$$
I_t \sim Poisson\left(\lambda_{t}\right | R_{t}, I_1, ..., I_{t-1}) = Poisson\left(R_{t} \sum_{s=1}^{t-1} I_{s} w_{t-s} \right)
$$

## Verosimilitud (Likelihood) {visibility="hidden"}

Una medida relativa de ajuste entre los datos y el modelo. Se define como una funci√≥n de R:

![https://www.reconlearn.org/slides/outbreak-statistics/outbreak-statistics#19](TallerEbola-qmd_files/img/likelihood_reminder.png)

## Instrucciones

<br>

### Lea y desarrolle las secci√≥n *6. Rt*

```{r}
countdown::countdown(minutes =10, seconds=0, left=0, right=0)
```

## Estimaci√≥n del n√∫mero reproductivo instant√°neo $R_t$

A continuaci√≥n, estimamos la transmisibilidad para ventanas de tiempo deslizantes de 1 semana (el valor predeterminado de **estimate_R**):

<font size="5">

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}

# Parametros de la distribuci√≥n gamma para el invertavlo serial
mean_si <- 8.7
std_si <-  6.1

configuracion_rt <- make_config(mean_si = mean_si, # Media de la distribuci√≥n SI 
                                std_si = std_si,  # Desviaci√≥n est√°ndar de la distribuci√≥n SI 
                                t_start = 2,                            # D√≠a de inicio de la ventana de tiempo
                                t_end = length(incidencia_diaria_truncada$counts)) # √öltimo d√≠a de la ventana de tiempo
```

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
config <- make_config(list(mean_si = mean_si, std_si = std_si)) 
# t_start y t_end se configuran autom√°ticamente para estimar R en ventanas deslizantes para 1 semana de forma predeterminada.
```

</font>

## Estimacion del n√∫mero reproductivo instant√°neo (Rt)

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
# use estimate_R using method = "parametric_si"
estimacion_rt <- estimate_R(incidencia_diaria_truncada, method = "parametric_si", 
                            si_data = si_data,
                            config = configuracion_rt)
# Observamos las estimaciones m√°s recientes de R(t)
tail(estimacion_rt$R[, c("t_start", "t_end", "Median(R)", 
                         "Quantile.0.025(R)", "Quantile.0.975(R)")])
```

## Estimacion del n√∫mero reproductivo instant√°neo (Rt)

```{r echo=TRUE, message=FALSE, warning=FALSE,comment=""}
plot(estimacion_rt, legend = FALSE)
```

<center>**¬øC√≥mo interpretar√≠a este resultado?**</center>

# Hemos llegado a la meta... <br> ¬°Gracias!
